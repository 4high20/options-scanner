(this["webpackJsonpoptions-scanner"]=this["webpackJsonpoptions-scanner"]||[]).push([[0],{145:function(e,t,n){var a,r,i;r=[],void 0===(i="function"===typeof(a=function(){if("WebSocket"in window)return e.prototype.onopen=function(e){},e.prototype.onclose=function(e){},e.prototype.onconnecting=function(e){},e.prototype.onmessage=function(e){},e.prototype.onerror=function(e){},e.debugAll=!1,e.CONNECTING=WebSocket.CONNECTING,e.OPEN=WebSocket.OPEN,e.CLOSING=WebSocket.CLOSING,e.CLOSED=WebSocket.CLOSED,e;function e(t,n,a){var r={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null,binaryType:"blob"};for(var i in a||(a={}),r)"undefined"!==typeof a[i]?this[i]=a[i]:this[i]=r[i];this.url=t,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var o,c=this,s=!1,u=!1,l=document.createElement("div");function m(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}l.addEventListener("open",(function(e){c.onopen(e)})),l.addEventListener("close",(function(e){c.onclose(e)})),l.addEventListener("connecting",(function(e){c.onconnecting(e)})),l.addEventListener("message",(function(e){c.onmessage(e)})),l.addEventListener("error",(function(e){c.onerror(e)})),this.addEventListener=l.addEventListener.bind(l),this.removeEventListener=l.removeEventListener.bind(l),this.dispatchEvent=l.dispatchEvent.bind(l),this.open=function(t){if((o=new WebSocket(c.url,n||[])).binaryType=this.binaryType,t){if(this.maxReconnectAttempts&&this.reconnectAttempts>this.maxReconnectAttempts)return}else l.dispatchEvent(m("connecting")),this.reconnectAttempts=0;(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",c.url);var a=o,r=setTimeout((function(){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",c.url),u=!0,a.close(),u=!1}),c.timeoutInterval);o.onopen=function(n){clearTimeout(r),(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onopen",c.url),c.protocol=o.protocol,c.readyState=WebSocket.OPEN,c.reconnectAttempts=0;var a=m("open");a.isReconnect=t,t=!1,l.dispatchEvent(a)},o.onclose=function(n){if(clearTimeout(r),o=null,s)c.readyState=WebSocket.CLOSED,l.dispatchEvent(m("close"));else{c.readyState=WebSocket.CONNECTING;var a=m("connecting");a.code=n.code,a.reason=n.reason,a.wasClean=n.wasClean,l.dispatchEvent(a),t||u||((c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onclose",c.url),l.dispatchEvent(m("close")));var r=c.reconnectInterval*Math.pow(c.reconnectDecay,c.reconnectAttempts);setTimeout((function(){c.reconnectAttempts++,c.open(!0)}),r>c.maxReconnectInterval?c.maxReconnectInterval:r)}},o.onmessage=function(t){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",c.url,t.data);var n=m("message");n.data=t.data,l.dispatchEvent(n)},o.onerror=function(t){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onerror",c.url,t),l.dispatchEvent(m("error"))}},1==this.automaticOpen&&this.open(!1),this.send=function(t){if(o)return(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","send",c.url,t),o.send(t);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(e,t){"undefined"==typeof e&&(e=1e3),s=!0,o&&o.close(e,t)},this.refresh=function(){o&&o.close()}}})?a.apply(t,r):a)||(e.exports=i)},173:function(e,t,n){e.exports=n(337)},178:function(e,t,n){},183:function(e,t,n){},315:function(e,t,n){},337:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(8),o=n.n(i),c=(n(178),n(37)),s=n(21),u=n(361),l=n(161),m=n(360),d=n(362),p=n(363),f=n(364),h=n(365),b=n(368),g=n(370),v=n(371),E=n(367),y=n(160),k=n.n(y),O=(n(183),n(26)),S=Object(O.b)({name:"websocket",initialState:{isOpen:!1,url:null},reducers:{open:function(e,t){var n=t.payload;e.isOpen=!0,e.url=n.url},close:function(e){e.isOpen=!1,e.url=null}}}),w=function(e){return function(t){t(S.actions.open({url:e}))}},C=function(){return function(e){e(S.actions.close())}},N=function(e){return e.websocket.isOpen},T=S.reducer;function j(){var e=Object(s.c)(N),t={backgroundColor:e?"#7aae1a":"#ff1111",borderRadius:"50%",marginRight:"8px",display:"inline-block",height:"12px",width:"12px"};return r.a.createElement("div",{style:{marginLeft:"4px",marginBottom:"4px"}},r.a.createElement("span",{style:t}),e?"Online":"Connecting...")}var x=n(159),I=n.n(x),L=n(158),R=n.n(L),A=n(141),F=n.n(A),M=n(142),D=n.n(M),W={palette:{primary:{main:"#fe9526"},secondary:{main:"#ffcc30"},success:{main:"#53d86a"},error:{main:"#fd3d39"}},overrides:{MuiPaper:{root:{borderRadius:"1px",padding:"8px"}}},props:{MuiPaper:{square:!0}},typography:{htmlFontSize:14,fontFamily:["Open Sans","Arial","sans-serif"].join(","),h1:{fontSize:"2.986rem"},h2:{fontSize:"2.488rem"},h3:{fontSize:"2.074rem"},h4:{fontSize:"1.728rem"},h5:{fontSize:"1.44rem"},h6:{fontSize:"1.2rem"}}},P={THEME_LIGHT:{palette:{type:"light"}},THEME_DARK:{palette:{type:"dark"}}},G=F()(P,(function(e){return D()(e,W)})),z=n(143),_=n.n(z),J=n(144),H=n.n(J),q=n(105),B=n.n(q),V=n(11),K=n.n(V),Z=n(145),$=n.n(Z),X=n(146),Q=n.n(X),U=n(102),Y=n.n(U),ee=n(147),te=n.n(ee),ne=new $.a("wss://www.deribit.com/ws/api/v2",null,{});ne.addEventListener("message",(function(e){var t=new CustomEvent("json");t.data=function e(t){return Y()(t)?te()(t,(function(t,n,a){return t[Q()(a)]=e(n),t}),{}):K()(t)?t.map((function(t){return e(t)})):t}(JSON.parse(e.data)),ne.dispatchEvent(t)})),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=null,a=1e4,r=2e3,i=function(){clearTimeout(n),n=setTimeout((function(){return console.warn("Connection is stale, no message received in ".concat(a/1e3," seconds")),t()}),a+r)};e.addEventListener("open",(function(){e.send(JSON.stringify({method:"public/set_heartbeat",params:{interval:Math.max(parseInt(a/1e3,10),10)},jsonrpc:"2.0",id:Date.now()}))})),e.addEventListener("close",(function(){clearTimeout(n)})),e.addEventListener("json",(function(t){i();var n=t.data;"heartbeat"===n.method&&"test_request"===n.params.type&&e.send(JSON.stringify({method:"public/test",params:{},jsonrpc:"2.0",id:Date.now()}))}))}(ne,ne.refresh);var ae={};ne.addEventListener("open",(function(e){ne.send(JSON.stringify({method:"public/subscribe",params:{channels:Object.keys(ae)},jsonrpc:"2.0",id:Date.now()}))})),ne.addEventListener("json",(function(e){var t=e.data;if("subscription"===t.method){var n=t.params,a=n.channel,r=n.data;ae[a]?ae[a](r):console.log("Ignoring subscription: ",a)}}));var re=Object(O.b)({name:"instruments",initialState:{instruments:{}},reducers:{success:function(e,t){var n=t.payload;e.instruments=n},clear:function(e){e.instruments={}}}}),ie=function(e){return function(t){return t(re.actions.clear()),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.timeout,a=void 0===n?1e4:n;return new Promise((function(t,n){var r=setTimeout(n,a,new Error("Call timed out")),i=Date.now(),o=JSON.stringify({method:e.method,params:e.params,jsonrpc:"2.0",id:i});ne.addEventListener("json",(function e(n){var a=n.data;if(a.id===i)return ne.removeEventListener("message",e),clearTimeout(r),t(a)})),1===ne.readyState?ne.send(o):ne.addEventListener("open",(function(){return ne.send(o)}),{once:!0})}))}({method:"public/get_instruments",params:{currency:e,kind:"option",expired:!1}}).then((function(e){return e.result})).then((function(e){return _()(e,["expirationTimestamp","strike","optionType"],["asc","asc","asc"])})).then((function(e){return H()(e,"instrumentName")})).then((function(e){return t(re.actions.success(e))}))}},oe=re.reducer,ce=Object(O.b)({name:"tickers",initialState:{tickers:{}},reducers:{update:function(e,t){var n=t.payload;e.tickers[n.instrumentName]=n},clear:function(e){e.tickers={}}}}),se=ce.actions,ue=ce.reducer,le=n(148),me=n(163),de=n(71),pe=n(149),fe=n(150),he=n(72),be=n(164),ge=n(162),ve=n(151),Ee=n.n(ve),ye=n(152),ke=(n(312),n(313),n(314),n(315),n(153)),Oe=n.n(ke),Se=function(e){Object(be.a)(n,e);var t=Object(ge.a)(n);function n(e){var a;return Object(pe.a)(this,n),(a=t.call(this,e)).valueChanged=function(e){var t=Object(he.a)(a);a.setState(Object(de.a)({},e.target.name,e.target.value),(function(){a.props.parentFilterInstance((function(e){var n=t.state,a=n.min,r=n.max;return a&&r?e.setModel({filterType:"number",type:"inRange",filter:a,filterTo:r}):a?e.setModel({filterType:"number",type:"greaterThanOrEqual",filter:a}):r?e.setModel({filterType:"number",type:"lessThanOrEqual",filter:r}):e.setModel(null)}))}))},a.state={min:"",max:""},a}return Object(fe.a)(n,[{key:"onParentModelChanged",value:function(e){switch(e?e.type:null){case"greaterThan":case"greaterThanOrEqual":return this.setState({min:e.filter});case"lessThan":case"lessThanOrEqual":return this.setState({max:e.filter});case"inRange":return this.setState({min:e.filter,max:e.filterTo});default:return this.setState({min:"",max:""})}}},{key:"render",value:function(){var e={width:"30%",margin:"0 2px",padding:"1px",display:"flex",alignItems:"center"};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"100%"},className:"ag-floating-filter-input"},r.a.createElement("input",{className:"ag-input-field-input ag-text-field-input",style:e,type:"number",value:this.state.min,name:"min",placeholder:"MIN",onChange:this.valueChanged}),r.a.createElement("input",{className:"ag-input-field-input ag-text-field-input",style:e,type:"number",value:this.state.max,name:"max",placeholder:"MAX",onChange:this.valueChanged})))}}]),n}(r.a.Component);var we=function(e){var t=e.options,n=e.instruments,a=[{field:"instrumentName",headerName:"Instrument",comparator:function(e,t){var n=e.match(/(\d+[A-Z]{3}\d\d)-(\d+)-([C|P])/),a=Object(c.a)(n,4),r=(a[0],a[1]),i=a[2],o=a[3],s=t.match(/(\d+[A-Z]{3}\d\d)-(\d+)-([C|P])/),u=Object(c.a)(s,4),l=(u[0],u[1]),m=u[2],d=u[3];return r!==l?new Date(r).getTime()-new Date(l).getTime():i!==m?parseFloat(i)-parseFloat(m):o.localeCompare(d)}},{field:"openInterest",filter:"agNumberColumnFilter",headerName:"Open Interest",type:"numericColumn"},{field:"markPrice",filter:"agNumberColumnFilter",headerName:"Mark Price",type:"numericColumn",valueFormatter:function(e){return"$".concat((e.value*e.data.underlyingPrice).toFixed(2)," (").concat(e.value.toFixed(8),")")}},{field:"markIv",filter:"agNumberColumnFilter",headerName:"IV (Mark)",type:"numericColumn",valueFormatter:function(e){return"".concat(e.value.toFixed(2))}}].concat(Object(me.a)([{headerName:"Delta",field:"greeks.delta"},{headerName:"Gamma",field:"greeks.gamma"},{headerName:"Vega",field:"greeks.vega"},{headerName:"Theta",field:"greeks.theta"}].map((function(e){return Object.assign(e,{filter:"agNumberColumnFilter",floatingFilterComponent:"customNumberMinMaxFilter",floatingFilterComponentParams:{suppressFilterButton:!0},type:"numericColumn",valueFormatter:function(e){return"".concat(e.value.toFixed(5))}})})))),i=Ee()(t,(function(e,t){return Object(le.a)({},e,{},n[t])})),o="dark"===Oe()().palette.type;return r.a.createElement("div",{id:"grid-wrapper"},r.a.createElement("div",{className:o?"ag-theme-balham-dark":"ag-theme-balham",style:{height:"95vh",width:"100%"}},r.a.createElement(ye.AgGridReact,{onGridReady:function(e){e.api.sizeColumnsToFit()},floatingFilter:!0,columnDefs:a,defaultColDef:{filter:!0,resizable:!0,sortable:!0},rowData:i,deltaRowDataMode:!0,getRowNodeId:function(e){return e.instrumentName},frameworkComponents:{customNumberMinMaxFilter:Se}})))},Ce=function(e){var t=e.currency,n=Object(s.b)(),a=Object(s.c)((function(e){return e.tickers.tickers})),i=Object(s.c)((function(e){return e.instruments.instruments}));return r.a.useEffect((function(){n(ie(t))}),[t,n]),r.a.useEffect((function(){var e=Object.keys(i).map((function(e){return"ticker.".concat(e,".100ms")}));return function(e,t){var n=B()(e);n.forEach((function(e,n){ae[e]=K()(t)?t[n]:t}));var a=JSON.stringify({method:"public/subscribe",params:{channels:n},jsonrpc:"2.0",id:Date.now()});1===ne.readyState?ne.send(a):ne.addEventListener("open",(function(){return ne.send(a)}),{once:!0})}(e,(function(e){return n(se.update(e))})),function(){!function(e){var t=B()(e);t.forEach((function(e){delete t[e]}));var n=JSON.stringify({method:"public/unsubscribe",params:{channels:t},jsonrpc:"2.0",id:Date.now()});1===ne.readyState?ne.send(n):ne.addEventListener("open",(function(){return ne.send(n)}),{once:!0})}(e),n(se.clear())}}),[i,n]),r.a.createElement(we,{instruments:i,options:a})};var Ne=function(){var e=Object(s.b)(),t=r.a.useState(!0),n=Object(c.a)(t,2),a=n[0],i=n[1],o=r.a.useState("www.deribit.com"),y=Object(c.a)(o,2),O=y[0],S=(y[1],r.a.useState("BTC")),N=Object(c.a)(S,2),T=N[0],x=N[1],L="wss://".concat(O,"/ws/api/v2"),A=Object(l.a)(a?G.THEME_DARK:G.THEME_LIGHT);return r.a.useEffect((function(){return e(w(L)),function(){return e(C())}}),[e,L]),r.a.createElement(m.a,{theme:A},r.a.createElement(u.a,null),r.a.createElement(d.a,{position:"static",style:{padding:"0px"}},r.a.createElement(p.a,{variant:"dense"},r.a.createElement(f.a,{container:!0,alignItems:"center",justify:"space-between"},r.a.createElement(f.a,{item:!0,xs:12,sm:"auto"},r.a.createElement(h.a,{variant:"h6"},"Deribit Options Scanner")),r.a.createElement(f.a,{item:!0},r.a.createElement(j,null)),r.a.createElement(f.a,{item:!0},r.a.createElement(b.a,{value:T,onChange:function(e){return x(e.target.value)},style:{margin:"0 8px"}},["BTC","ETH"].map((function(e){return r.a.createElement(g.a,{key:e,value:e},e)}))),r.a.createElement(v.a,{title:"Toggle light/dark theme"},r.a.createElement(E.a,{onClick:function(){return i(!a)},"aria-label":"Toggle light/dark theme"},a?r.a.createElement(R.a,null):r.a.createElement(I.a,null))),r.a.createElement(v.a,{title:"Github repository"},r.a.createElement(E.a,{"aria-label":"Github repository",href:"https://github.com/thetaseek/options-scanner",target:"_blank",rel:"noreferrer noopener"},r.a.createElement(k.a,null))))))),r.a.createElement(Ce,{url:L,currency:T}))},Te=Object(O.a)({middleware:Object(O.c)({thunk:!0,immutableCheck:!1,serializableCheck:!1}),reducer:{instruments:oe,tickers:ue,websocket:T}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,{store:Te},r.a.createElement(Ne,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[173,1,2]]]);
//# sourceMappingURL=main.013748d3.chunk.js.map